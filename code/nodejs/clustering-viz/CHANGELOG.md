# 更新日志 (Changelog)

本文档记录了聚类可视化项目的所有重要变更。

---

## [1.2.0] - 2025-10-09

### 新增功能

#### UMAP 降维支持
- 🎉 添加 UMAP (Uniform Manifold Approximation and Projection) 作为可选的降维方法
- 用户可在 PCA 和 UMAP 之间自由切换
- 智能处理小样本量：少于 10 个样本自动回退到 PCA
- 动态调整 UMAP 参数以适应不同数据集大小

#### 前端用户界面
- 新增降维方法选择器（绿色主题按钮）
- 支持实时切换降维方法并自动重新执行聚类
- 国际化支持（中文/英文）

### 重大修复

#### 聚类中心代表性问题 ⚠️ CRITICAL FIX
**问题描述**：
- 之前的实现中，数据点和聚类中心分别进行降维
- 当数据量大（如 1000 个点）时使用 UMAP，但中心点少（3-4 个）时自动回退到 PCA
- 导致中心点和数据点在不同的 2D 空间中，可视化不准确

**解决方案**：
- 新增 `server/visualization.js` 模块
- 实现 `computeReducedCentroids()` 函数
- 在降维后的 2D 空间中重新计算聚类中心
- 确保中心点位置准确反映其簇内点的均值

**影响范围**：
- `/api/cluster` 端点
- `/api/compare` 端点
- 所有聚类方法（K-Means, Mean-Shift, MOG）

**文件变更**：
```
+ server/visualization.js          (新增)
M server/index.js                  (修改聚类中心计算逻辑)
M UMAP_FEATURE.md                 (文档更新)
```

### 用户体验改进

#### 简洁可视化
- 移除 X/Y 坐标轴，聚焦聚类结果
- 优化边距配置：`{top: 20, right: 20, bottom: 20, left: 20}`
- 提供更大的可视化区域
- 减少视觉干扰

### 性能数据

#### 降维方法性能对比（Iris 数据集，150 样本，4 维）
| 方法 | 耗时 | 速度 |
|------|------|------|
| PCA  | ~2ms | 基准 |
| UMAP | ~150ms | 75x 慢 |

#### 降维方法性能对比（MNIST 小，1000 样本，784 维）
| 方法 | 耗时 | 速度 |
|------|------|------|
| PCA  | ~2.8s | 基准 |
| UMAP | ~1.2s | 2.3x 快 |

**注意**：对于高维数据（如 MNIST 的 784 维），UMAP 实际上可能比 PCA 更快，因为它采用了不同的优化策略。

### 技术栈更新
- 新增依赖：`umap-js@1.4.0`
- 现有依赖：`ml-pca@4.1.1`, `ml-kmeans@6.0.0`, `express@5.1.0`, `d3@7.x`

---

## [1.1.0] - 2025-10-08

### 验证与测试

#### K-Means 实现验证
- ✅ 确认使用标准的 `ml-kmeans` 库（v6.0.0）
- ✅ 支持 kmeans++ 初始化
- ✅ 创建完整的测试套件（6 个测试用例）
- ✅ 所有测试 100% 通过

#### 测试覆盖
1. 简单 2D 聚类测试
2. Iris 数据集测试（鸢尾花分类）
3. PCA 降维测试
4. 参数敏感性测试
5. 可重复性测试（随机种子）
6. Wine 数据集测试

#### 质量指标
- Iris 数据集聚类纯度：88.67%
- 所有测试用例通过率：100%

### 文档
- 新增 `REVIEW_REPORT.md`（技术审查报告）
- 新增 `test/kmeans-test.js`（测试套件）

---

## [1.0.0] - 初始版本

### 核心功能
- 🎯 三种聚类算法：K-Means、Mean-Shift、MOG（混合高斯模型）
- 📊 四个内置数据集：MNIST-Small、MNIST-Medium、Iris、Wine
- 🎨 D3.js 实现的交互式可视化
- 🌐 Express.js REST API 架构
- 🌍 中英文双语支持

### 聚类算法特点

#### K-Means
- 快速高效
- 需要指定聚类数 K
- 适合球形簇

#### Mean-Shift
- 自动发现聚类数
- 基于密度的聚类
- 适合任意形状的簇
- 自动估计 bandwidth 参数

#### MOG (Mixture of Gaussians)
- 概率模型
- 软聚类（每个点有概率分布）
- 适合重叠数据
- 使用 EM 算法优化

### 降维技术
- PCA（主成分分析）用于高维数据可视化
- 自动处理维度 > 2 的数据

### 可视化特性
- 散点图显示聚类结果
- 颜色编码区分不同簇
- 聚类中心用十字标记
- 实时显示计算时间和聚类数

---

## 开发规范

### 版本号说明
本项目遵循语义化版本规范（Semantic Versioning）：

- **主版本号（Major）**：重大架构变更或不兼容的 API 变更
- **次版本号（Minor）**：新功能添加，向后兼容
- **修订号（Patch）**：Bug 修复，向后兼容

### 分类标签
- **新增功能**：新功能或特性
- **重大修复**：修复重要的 Bug
- **用户体验改进**：UI/UX 优化
- **性能优化**：性能提升
- **文档**：文档更新
- **技术栈更新**：依赖项变更

---

## 贡献者

- 初始开发：Hongxin
- AI 辅助：Claude (Anthropic)

---

## 许可证

本项目采用 MIT 许可证。详见 LICENSE 文件。
